# trivy-vulnerability-exporter

A Prometheus Exporter that collects all vulnerabilities detected by aquasecurity/trivy in kubernetes clusters.

Inspirated by [kube-trivy-expoter](https://github.com/kaidotdev/kube-trivy-exporter).

This exporter is written on top of [cobra library](https://github.com/spf13/cobra) and [trivy cli](https://github.com/aquasecurity/trivy).

## Requirements

- Kubernetes cluster
- Install the exporter using helm to setup the RBAC
- Prometheus
- Grafana

## Grafana dashboards


## Install the exporter


## Image Scan


## Node Scan



## Development Environment

- You could upgrade trivy version on the Dockerfile:

```
ENV TRIVYVERSION=v0.32.0
```

- After that, import the new trivy library:

```
go get github.com/aquasecurity/trivy/pkg/report@v0.32.0
go mod tidy
```


## ToDo

- Create a makefile for development environment
- Improve the unit tests
